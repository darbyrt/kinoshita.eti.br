{"segments": {"content": "<p>I have been playing with R and its packages for some time, and decided to study it a \nbit harder. Last week I started reading the <a href=\"http://adv-r.had.co.nz/\">Advanced R Programming</a> \nby Hadley Wickham. </p>\n<p>One of the first chapters talks about the basic data structures in R. In order to \nget my feet wet I thought about a simple example: <a href=\"http://en.wikipedia.org/wiki/Treemapping\">treemapping</a> \nJenkins extension points. </p>\n<p style=\"text-align: center;\"><a href=\"/2014/05/19/treemapping-jenkins-extension-points-with-r/extension_points.png\"><img src=\"/2014/05/19/treemapping-jenkins-extension-points-with-r/extension_points.png\" width=\"600px\" alt=\"Treemap graph\" /></a></p>\n\n<p>There is a <a href=\"https://wiki.jenkins-ci.org/display/JENKINS/Extension+points\">Wiki page with the extension points in Jenkins</a> (what parts of Jenkins can be customized) \nand its implementations. That page is generated by a <a href=\"https://ci.jenkins-ci.org/view/Infrastructure/job/infra_extension-indexer/\">Jenkins job</a>. </p>\n<p>That job outputs a JSON file that contains each available extension points, as well as \nan array with its implementations. The R code below will produce two vectors, one with the \ncount of implementations of each extension point, and the other with the class name.</p>\n<div class=\"highlight\"><pre>nExtensionPoints <span class=\"o\">&lt;-</span> <span class=\"kp\">length</span><span class=\"p\">(</span>extensionPointsJson<span class=\"o\">$</span>extensionPoints<span class=\"p\">)</span>\nnumberOfImplementations <span class=\"o\">&lt;-</span> <span class=\"kt\">vector</span><span class=\"p\">(</span>length <span class=\"o\">=</span> nExtensionPoints<span class=\"p\">)</span>\nnamesOfTheExtensionPoints <span class=\"o\">&lt;-</span> <span class=\"kt\">vector</span><span class=\"p\">(</span>length <span class=\"o\">=</span> nExtensionPoints<span class=\"p\">)</span>\n<span class=\"kr\">for</span> <span class=\"p\">(</span>i <span class=\"kr\">in</span> <span class=\"kp\">seq_along</span><span class=\"p\">(</span>extensionPoints<span class=\"p\">))</span> <span class=\"p\">{</span>\n  extensionName <span class=\"o\">=</span> extensionPoints<span class=\"p\">[[</span>i<span class=\"p\">]]</span><span class=\"o\">$</span>className\n  lastIndexOfDot <span class=\"o\">=</span> <span class=\"kp\">regexpr</span><span class=\"p\">(</span><span class=\"s\">&quot;\\\\.[^\\\\.]*$&quot;</span><span class=\"p\">,</span> extensionName<span class=\"p\">)</span>\n  namesOfTheExtensionPoints<span class=\"p\">[[</span>i<span class=\"p\">]]</span> <span class=\"o\">=</span> <span class=\"kp\">substr</span><span class=\"p\">(</span>extensionName<span class=\"p\">,</span> lastIndexOfDot<span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"m\">+1</span><span class=\"p\">,</span> <span class=\"kp\">nchar</span><span class=\"p\">(</span>extensionName<span class=\"p\">))</span>\n  numberOfImplementations<span class=\"p\">[[</span>i<span class=\"p\">]]</span> <span class=\"o\">=</span> <span class=\"kp\">length</span><span class=\"p\">(</span>extensionPoints<span class=\"p\">[[</span>i<span class=\"p\">]]</span><span class=\"o\">$</span>implementations<span class=\"p\">)</span>\n  <span class=\"kp\">print</span><span class=\"p\">(</span><span class=\"kp\">paste</span><span class=\"p\">(</span>namesOfTheExtensionPoints<span class=\"p\">[[</span>i<span class=\"p\">]],</span> <span class=\"s\">&quot; -&gt; &quot;</span><span class=\"p\">,</span> numberOfImplementations<span class=\"p\">[[</span>i<span class=\"p\">]]))</span>\n<span class=\"p\">}</span>\n</pre></div>\n\n<p>For creating the treemap I used the <strong><a href=\"http://flowingdata.com/2010/02/11/an-easy-way-to-make-a-treemap/\">portfolio package</a></strong>, and the <code>map.market</code> \nfunction. The structures previously created and the next snippet of code are all that is \nneeded to create the treemap of the Jenkins extension points.</p>\n<div class=\"highlight\"><pre>map.market<span class=\"p\">(</span>id<span class=\"o\">=</span><span class=\"kp\">seq_along</span><span class=\"p\">(</span>extensionPoints<span class=\"p\">),</span> area<span class=\"o\">=</span>numberOfImplementations<span class=\"p\">,</span> group<span class=\"o\">=</span>namesOfTheExtensionPoints<span class=\"p\">,</span> color<span class=\"o\">=</span>numberOfImplementations<span class=\"p\">,</span> main<span class=\"o\">=</span><span class=\"s\">&quot;Jenkins Extension Points&quot;</span><span class=\"p\">)</span>\n</pre></div>\n\n<p>You can also use the <a href=\"https://wiki.jenkins-ci.org/display/JENKINS/R+Plugin\">Jenkins R Plug-in</a> to produce this graph, \nas in this <a href=\"http://builds.tupilabs.com/job/backend-extension-points-treemap/2/\">sample job</a>. \nYou can get the complete script in this <a href=\"https://gist.github.com/kinow/d5a2221c32dce3aa1076\">gist</a>, or just \ncopy it here.</p>\n<div class=\"highlight\"><pre><span class=\"kn\">library</span><span class=\"p\">(</span><span class=\"s\">&#39;rjson&#39;</span><span class=\"p\">)</span>\n<span class=\"kn\">library</span><span class=\"p\">(</span><span class=\"s\">&#39;portfolio&#39;</span><span class=\"p\">)</span>\n\ndownload.file<span class=\"p\">(</span>url<span class=\"o\">=</span><span class=\"s\">&quot;https://ci.jenkins-ci.org/view/Infrastructure/job/infra_extension-indexer/ws/extension-points.json&quot;</span><span class=\"p\">,</span> destfile<span class=\"o\">=</span><span class=\"s\">&quot;extension-points.json&quot;</span><span class=\"p\">,</span> method<span class=\"o\">=</span><span class=\"s\">&quot;wget&quot;</span><span class=\"p\">)</span>\nextensionPointsJson <span class=\"o\">&lt;-</span> fromJSON<span class=\"p\">(</span><span class=\"kp\">paste</span><span class=\"p\">(</span><span class=\"kp\">readLines</span><span class=\"p\">(</span><span class=\"s\">&quot;extension-points.json&quot;</span><span class=\"p\">),</span> collapse<span class=\"o\">=</span><span class=\"s\">&quot;&quot;</span><span class=\"p\">))</span>\nextensionPoints <span class=\"o\">&lt;-</span> extensionPointsJson<span class=\"o\">$</span>extensionPoints\nnExtensionPoints <span class=\"o\">&lt;-</span> <span class=\"kp\">length</span><span class=\"p\">(</span>extensionPointsJson<span class=\"o\">$</span>extensionPoints<span class=\"p\">)</span>\nnumberOfImplementations <span class=\"o\">&lt;-</span> <span class=\"kt\">vector</span><span class=\"p\">(</span>length <span class=\"o\">=</span> nExtensionPoints<span class=\"p\">)</span>\nnamesOfTheExtensionPoints <span class=\"o\">&lt;-</span> <span class=\"kt\">vector</span><span class=\"p\">(</span>length <span class=\"o\">=</span> nExtensionPoints<span class=\"p\">)</span>\n<span class=\"kr\">for</span> <span class=\"p\">(</span>i <span class=\"kr\">in</span> <span class=\"kp\">seq_along</span><span class=\"p\">(</span>extensionPoints<span class=\"p\">))</span> <span class=\"p\">{</span>\n  extensionName <span class=\"o\">=</span> extensionPoints<span class=\"p\">[[</span>i<span class=\"p\">]]</span><span class=\"o\">$</span>className\n  lastIndexOfDot <span class=\"o\">=</span> <span class=\"kp\">regexpr</span><span class=\"p\">(</span><span class=\"s\">&quot;\\\\.[^\\\\.]*$&quot;</span><span class=\"p\">,</span> extensionName<span class=\"p\">)</span>\n  namesOfTheExtensionPoints<span class=\"p\">[[</span>i<span class=\"p\">]]</span> <span class=\"o\">=</span> <span class=\"kp\">substr</span><span class=\"p\">(</span>extensionName<span class=\"p\">,</span> lastIndexOfDot<span class=\"p\">[</span><span class=\"m\">1</span><span class=\"p\">]</span><span class=\"m\">+1</span><span class=\"p\">,</span> <span class=\"kp\">nchar</span><span class=\"p\">(</span>extensionName<span class=\"p\">))</span>\n  numberOfImplementations<span class=\"p\">[[</span>i<span class=\"p\">]]</span> <span class=\"o\">=</span> <span class=\"kp\">length</span><span class=\"p\">(</span>extensionPoints<span class=\"p\">[[</span>i<span class=\"p\">]]</span><span class=\"o\">$</span>implementations<span class=\"p\">)</span>\n  <span class=\"kp\">print</span><span class=\"p\">(</span><span class=\"kp\">paste</span><span class=\"p\">(</span>namesOfTheExtensionPoints<span class=\"p\">[[</span>i<span class=\"p\">]],</span> <span class=\"s\">&quot; -&gt; &quot;</span><span class=\"p\">,</span> numberOfImplementations<span class=\"p\">[[</span>i<span class=\"p\">]]))</span>\n<span class=\"p\">}</span>\npng<span class=\"p\">(</span>filename<span class=\"o\">=</span><span class=\"s\">&quot;extension-points.png&quot;</span><span class=\"p\">,</span> width<span class=\"o\">=</span><span class=\"m\">2048</span><span class=\"p\">,</span> height<span class=\"o\">=</span><span class=\"m\">1536</span><span class=\"p\">,</span> units<span class=\"o\">=</span><span class=\"s\">&quot;px&quot;</span><span class=\"p\">,</span> bg<span class=\"o\">=</span><span class=\"s\">&quot;white&quot;</span><span class=\"p\">)</span>\nmap.market<span class=\"p\">(</span>id<span class=\"o\">=</span><span class=\"kp\">seq_along</span><span class=\"p\">(</span>extensionPoints<span class=\"p\">),</span> area<span class=\"o\">=</span>numberOfImplementations<span class=\"p\">,</span> group<span class=\"o\">=</span>namesOfTheExtensionPoints<span class=\"p\">,</span> color<span class=\"o\">=</span>numberOfImplementations<span class=\"p\">,</span> main<span class=\"o\">=</span><span class=\"s\">&quot;Jenkins Extension Points&quot;</span><span class=\"p\">)</span>\ndev.off<span class=\"p\">()</span>\n</pre></div>"}, "pass_info": {"used_taxonomy_terms": [], "used_pagination": false, "pagination_has_more": false, "used_assets": true, "used_source_names": []}}