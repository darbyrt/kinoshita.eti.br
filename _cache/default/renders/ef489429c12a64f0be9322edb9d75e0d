{"segments": {"content": "<p>Having run <a href=\"http://graphite.wikidot.com/\">Graphite</a> for a while, today I found a rather annoying issue. We were using \n<a href=\"https://code.launchpad.net/~lucio.torre/graphite/add-events/+merge/69142\">events</a>, and everything was working perfectly fine so far. But for the 24 last hours, \nthe graph was blank. </p>\n<p>Actually, in the dashboard, the graph was <em>missing</em>, being displayed as a gray box. \nEnabling the web inspector in Google Chrome I got the graph URL. Opening the link in \na new tab gave me the exception message: <strong>too many SQL variables</strong> (<sup>1</sup>).</p>\n<p>After some research, I found out this was a bug in SQLite. After trying to hack the code, \nand being concerned about using a patched version of Graphite and having to update it \nlater, I decided to switch database. </p>\n<p>But to avoid losing the graphs, users and other settings, including the events, I \nmigrated the SQLite database to a MySQL server. This MySQL server was already installed in \nthe server machine, since this machine hosted a <a href=\"http://www.zabbix.com/\">Zabbix</a> server too.</p>\n<p>Here are the steps required to migrate your database from SQLite to MySQL (<sup>2</sup>).</p>\n<ul>\n<li>Download <strong>sqlite3_mysql</strong> python script from <a href=\"http://www.redmine.org/boards/2/topics/12793\">http://www.redmine.org/boards/2/topics/12793</a></li>\n<li>Stop Apache/Nginx</li>\n<li>mysql -u user -p -e &#8220;create database redmine graphite set utf8;&#8221; </li>\n<li>sqlite3 graphite.db .dump | sqlite3-to-mysql.py | mysql -uroot -pyourpass graphite</li>\n<li>Start Apache again</li>\n</ul>\n<p>After tail&#8217;ing the Graphite webapp log file, </p>\n<div class=\"highlight\"><pre>tail f- storage/log/webapp/error.log\n</pre></div>\n\n<p>I noticed the Python MySQLdb wasn&#8217;t installed.</p>\n<div class=\"highlight\"><pre><span class=\"n\">ImproperlyConfigured</span><span class=\"p\">:</span> <span class=\"n\">Error</span> <span class=\"n\">loading</span> <span class=\"n\">MySQLdb</span> <span class=\"n\">module</span><span class=\"p\">:</span> <span class=\"n\">No</span> <span class=\"n\">module</span> <span class=\"n\">named</span> <span class=\"n\">MySQLdb</span>\n</pre></div>\n\n<p>My server was an Ubuntu 13.04, so I installed the module simply with the following \ncommand.</p>\n<div class=\"highlight\"><pre>apt-get install python-mysqldb\n</pre></div>\n\n<p>Hope that helps!</p>\n<p><small><sup>1</sup> You may have to enable *DEBUG* in your Django settings for seeing the exception in your browser</small></p>\n\n<p><small><sup>2</sup> Zabbix needed some minor tweaks in order to use [MariaDB](https://mariadb.org/), but probably you can give it a try too</small></p>"}, "pass_info": {"used_taxonomy_terms": [], "used_pagination": false, "pagination_has_more": false, "used_assets": false, "used_source_names": []}}