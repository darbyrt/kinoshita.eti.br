{"segments": {"content": "<p>This week I had to write my first custom command for <a href=\"http://laravel.com/\">Laravel 4</a>. \nIn <a href=\"http://nestor-qa.org/\">Nestor-QA</a>, <a href=\"https://github.com/tooh\">Peter</a> and I thought it would be useful to have \nthe database schema being automatically generated with \n<a href=\"http://schemaspy.sourceforge.net/\">SchemaSpy</a> in our <a href=\"http://builds.tupilabs.com/view/Nestor-QA/\">Jenkins box</a>.</p>\n<p>Thanks to <a href=\"http://laravel.com/docs/artisan\">Artisan</a> this task is much simpler than I thought. \nThe following command creates the <code>schemaspy</code> command.</p>\n<pre><code>php artisan command:make SchemaSpyCommand --command=schemaspy\n</code></pre>\n<p>This will create the file <code>app/commands/SchemaSpyCommand.php</code>. And all I had to do was \njust fill in the options and write the exec command as the <a href=\"http://laravel.com/docs/commands\">Laravel 4 docs</a> explain. </p>\n<pre><code>$this-&gt;info('Creating SchemaSpy');\n\n$jar = $this-&gt;option(\"jar\");\n$dbtype = $this-&gt;option(\"dbtype\");\n$output = $this-&gt;option(\"output\");\n\n$commandLine = sprintf(\"java -jar %s -u none -t %s -o %s\", $jar, $dbtype, $output);\n\n$this-&gt;info(sprintf(\"Command line: [%s]\", $commandLine));\n\nexec($commandLine);\n</code></pre>\n<p>That&#8217;s how my final command looks. Now the final step is integrate it into the application by adding the line below to \n<code>app/start/artisan.php</code>.</p>\n<pre><code>Artisan::add(new SchemaSpyCommand);\n</code></pre>\n<p>And that&#8217;s it, running <code>php artisan schemaspy --jar=/opt/schemaspy/schemaSpy_5.0.0.jar \n--dbtype=app/database/sqlite.properties --output=database-schema</code> \ncreates the database schema docs in the <code>database-schema</code> directory. </p>\n<p>Check this <a href=\"https://gist.github.com/kinow/8936667\">gist</a> for the final code.</p>\n<p>Happy coding!</p>"}, "pass_info": {"used_taxonomy_terms": [], "used_pagination": false, "pagination_has_more": false, "used_assets": false, "used_source_names": []}}