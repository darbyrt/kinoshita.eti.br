{"content": {"content": [{"o": 138, "f": null, "c": "I have been playing with R and its packages for some time, and decided to study it a \nbit harder. Last week I started reading the [Advanced R Programming](http://adv-r.had.co.nz/) \nby Hadley Wickham. \n\nOne of the first chapters talks about the basic data structures in R. In order to \nget my feet wet I thought about a simple example: [treemapping](http://en.wikipedia.org/wiki/Treemapping) \nJenkins extension points. \n\n<p style=\"text-align: center;\"><a href=\"{{assets.extension_points}}\"><img src=\"{{assets.extension_points}}\" width=\"600px\" alt=\"Treemap graph\" /></a></p>\n\nThere is a [Wiki page with the extension points in Jenkins](https://wiki.jenkins-ci.org/display/JENKINS/Extension+points) (what parts of Jenkins can be customized) \nand its implementations. That page is generated by a [Jenkins job](https://ci.jenkins-ci.org/view/Infrastructure/job/infra_extension-indexer/). \n\nThat job outputs a JSON file that contains each available extension points, as well as \nan array with its implementations. The R code below will produce two vectors, one with the \ncount of implementations of each extension point, and the other with the class name.\n\n{% geshi 'r' %}\nnExtensionPoints <- length(extensionPointsJson$extensionPoints)\nnumberOfImplementations <- vector(length = nExtensionPoints)\nnamesOfTheExtensionPoints <- vector(length = nExtensionPoints)\nfor (i in seq_along(extensionPoints)) {\n  extensionName = extensionPoints[[i]]$className\n  lastIndexOfDot = regexpr(\"\\\\.[^\\\\.]*$\", extensionName)\n  namesOfTheExtensionPoints[[i]] = substr(extensionName, lastIndexOfDot[1]+1, nchar(extensionName))\n  numberOfImplementations[[i]] = length(extensionPoints[[i]]$implementations)\n  print(paste(namesOfTheExtensionPoints[[i]], \" -> \", numberOfImplementations[[i]]))\n}\n{% endgeshi %}\n\nFor creating the treemap I used the **[portfolio package](http://flowingdata.com/2010/02/11/an-easy-way-to-make-a-treemap/)**, and the <code>map.market</code> \nfunction. The structures previously created and the next snippet of code are all that is \nneeded to create the treemap of the Jenkins extension points.\n\n{% geshi 'r' %}\nmap.market(id=seq_along(extensionPoints), area=numberOfImplementations, group=namesOfTheExtensionPoints, color=numberOfImplementations, main=\"Jenkins Extension Points\")\n{% endgeshi %}\n\nYou can also use the [Jenkins R Plug-in](https://wiki.jenkins-ci.org/display/JENKINS/R+Plugin) to produce this graph, \nas in this [sample job](http://builds.tupilabs.com/job/backend-extension-points-treemap/2/). \nYou can get the complete script in this [gist](https://gist.github.com/kinow/d5a2221c32dce3aa1076), or just \ncopy it here.\n\n{% geshi 'r' %}\nlibrary('rjson')\nlibrary('portfolio')\n \ndownload.file(url=\"https://ci.jenkins-ci.org/view/Infrastructure/job/infra_extension-indexer/ws/extension-points.json\", destfile=\"extension-points.json\", method=\"wget\")\nextensionPointsJson <- fromJSON(paste(readLines(\"extension-points.json\"), collapse=\"\"))\nextensionPoints <- extensionPointsJson$extensionPoints\nnExtensionPoints <- length(extensionPointsJson$extensionPoints)\nnumberOfImplementations <- vector(length = nExtensionPoints)\nnamesOfTheExtensionPoints <- vector(length = nExtensionPoints)\nfor (i in seq_along(extensionPoints)) {\n  extensionName = extensionPoints[[i]]$className\n  lastIndexOfDot = regexpr(\"\\\\.[^\\\\.]*$\", extensionName)\n  namesOfTheExtensionPoints[[i]] = substr(extensionName, lastIndexOfDot[1]+1, nchar(extensionName))\n  numberOfImplementations[[i]] = length(extensionPoints[[i]]$implementations)\n  print(paste(namesOfTheExtensionPoints[[i]], \" -> \", numberOfImplementations[[i]]))\n}\npng(filename=\"extension-points.png\", width=2048, height=1536, units=\"px\", bg=\"white\")\nmap.market(id=seq_along(extensionPoints), area=numberOfImplementations, group=namesOfTheExtensionPoints, color=numberOfImplementations, main=\"Jenkins Extension Points\")\ndev.off()\n{% endgeshi %}", "l": 9}]}, "config": {"title": "Treemapping Jenkins Extension Points with R", "author": "kinow", "tags": ["jenkins", "r"], "category": "blog", "time": "00:51:33", "format": null, "content_type": "html", "segments": ["content"]}}