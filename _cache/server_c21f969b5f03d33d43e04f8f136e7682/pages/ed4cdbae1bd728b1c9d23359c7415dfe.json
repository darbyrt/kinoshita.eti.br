{"content": {"content": [{"o": 159, "f": null, "c": "Having run [Graphite](http://graphite.wikidot.com/) for a while, today I found a rather annoying issue. We were using \n[events](https://code.launchpad.net/~lucio.torre/graphite/add-events/+merge/69142), and everything was working perfectly fine so far. But for the 24 last hours, \nthe graph was blank. \n\nActually, in the dashboard, the graph was *missing*, being displayed as a gray box. \nEnabling the web inspector in Google Chrome I got the graph URL. Opening the link in \na new tab gave me the exception message: **too many SQL variables** (<sup>1</sup>).\n\nAfter some research, I found out this was a bug in SQLite. After trying to hack the code, \nand being concerned about using a patched version of Graphite and having to update it \nlater, I decided to switch database. \n\nBut to avoid losing the graphs, users and other settings, including the events, I \nmigrated the SQLite database to a MySQL server. This MySQL server was already installed in \nthe server machine, since this machine hosted a [Zabbix](http://www.zabbix.com/) server too.\n\nHere are the steps required to migrate your database from SQLite to MySQL (<sup>2</sup>).\n\n* Download **sqlite3_mysql** python script from [http://www.redmine.org/boards/2/topics/12793](http://www.redmine.org/boards/2/topics/12793)\n* Stop Apache/Nginx\n* mysql -u user -p -e \"create database redmine graphite set utf8;\" \n* sqlite3 graphite.db .dump | sqlite3-to-mysql.py | mysql -uroot -pyourpass graphite\n* Start Apache again\n\nAfter tail'ing the Graphite webapp log file, \n\n{% geshi 'shell' %}\ntail f- storage/log/webapp/error.log\n{% endgeshi %}\n\nI noticed the Python MySQLdb wasn't installed.\n\n{% geshi 'python' %}\nImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb\n{% endgeshi %}\n\nMy server was an Ubuntu 13.04, so I installed the module simply with the following \ncommand.\n\n{% geshi 'shell' %}\napt-get install python-mysqldb\n{% endgeshi %}\n\nHope that helps!\n\n<p><small><sup>1</sup> You may have to enable *DEBUG* in your Django settings for seeing the exception in your browser</small></p>\n<p><small><sup>2</sup> Zabbix needed some minor tweaks in order to use [MariaDB](https://mariadb.org/), but probably you can give it a try too</small></p>", "l": 9}]}, "config": {"title": "Too many SQL variables exception in Graphite with SQLite3", "author": "kinow", "tags": ["monitoring", "python"], "category": "blog", "time": "13:54:53", "format": null, "content_type": "html", "segments": ["content"]}}