  
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
    <title>Bruno P. Kinoshita</title> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="Bruno de Paula Kinoshita personal web site" />
    <meta name="keywords"
        content="kinoshita, bruno de paula kinoshita, geek, geek stuff, java, python, c, c++, msn now playing, neural network, mackenzie, sao paulo, brasil, brazil, nerd, nerd stuff, cool, jenkins, illustration, quadrinhos, machine learning, linguistic, apache, open source, codigo livre, codigo aberto" />
    <meta name="author" content="" />
    <meta name="generator" content="PieCrust 2.0.0" />
    <meta name="template-engine" content="Twig" />
    <meta name="robots" content="all=index,follow" />
    <meta name="revisit-after" content="15 days" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta name="distribution" content="Global" />
    <meta name="url" content="/" />
    <meta name="copyright" content="Bruno de Paula Kinoshita" />
    <meta name="Googlebot" content="all" />
    <meta name="rating" content="general" />
    <meta http-equiv="expires" content="0" />
    <meta name="city" content="Sao Paulo" />
    <meta name="state" content="Brasil, Sao Paulo" />
    <meta http-equiv="content-language" content="en" />
    <meta http-equiv="imagetoolbar" content="no" />
    <meta id="page_favicon" href="/favicon.ico" rel="icon" type="image/x-icon" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="alternate" type="application/rss+xml" title="Bruno P. Kinoshita &raquo; Feed" href="/feed.xml" />
    <link rel="stylesheet" href="/css/semantic/dist/semantic.min.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection" />
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/css/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    <link rel="stylesheet" href="/css/prettyPhoto.css" type="text/css" media="all" />
</head>
<body id="body">
    <div class="ui vertical sidebar menu" id="toc">
        <div class="menu">
    <div class="item">
        <a href="/" class="main-link">Kinoshita</a>
    </div>
    <div class="item">
        <a href="/software/">Software</a>
    </div>
    <div class="item">
        <a href="/articles/">Articles</a>
    </div>
    <div class="item">
        <a href="/books/">Books</a>
    </div>
    <div class="item">
        <a href="/about/">About &#038; CV</a>
    </div>
    <div class="item">
        <a href="/contact/">Contact</a>
    </div>
</div>
<img id="me" src="/img/bruno.jpg" title="Hmmmm" alt="Hmmmm" width="134px" height="215px" />
    </div>
    <div class="ui black big launch right attached fixed button">
        <i class="content icon"></i>
        <span class="text">Menu</span>
    </div>
    <div class="ui fixed inverted main menu">
        <div class="ui container">
            <a class="launch icon item">
                <i class="content icon"></i>
            </a>
            <div class="item">
                None
            </div>
        </div>
    </div>
    <div class="pusher">
        <div class="full height">
            <div class="toc">
                <div class="ui vertical sticky fixed top menu">
                    <div class="menu">
    <div class="item">
        <a href="/" class="main-link">Kinoshita</a>
    </div>
    <div class="item">
        <a href="/software/">Software</a>
    </div>
    <div class="item">
        <a href="/articles/">Articles</a>
    </div>
    <div class="item">
        <a href="/books/">Books</a>
    </div>
    <div class="item">
        <a href="/about/">About &#038; CV</a>
    </div>
    <div class="item">
        <a href="/contact/">Contact</a>
    </div>
</div>
<img id="me" src="/img/bruno.jpg" title="Hmmmm" alt="Hmmmm" width="134px" height="215px" />
                </div>
            </div>
            <div class="article">
                <div class="main container">

                
                    
                    <p>Posts tagged with &#8216;python&#8217;</p>
<div class="ui raised padded container segment">
    <h2>Using Requests Session Objects for web scraping</h2>
    <p><small>kinow</small> @ <small>Nov 25, 2016&nbsp;01:24:03</small></p>







<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://kinoshita.eti.br/2016/11/25/using-requests-session-objects-for-web-scraping" data-text="Using Requests Session Objects for web scraping" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>I had to write a Python script some months ago, that would retrieve Solar energy
data from a web site. It was basically a handful of HTTP calls, parse the response
that was mainly in JSON, and store the results as JSON and CSV for processing later.</p>
<p>Since it was such a small task, I used the <a href="http://docs.python-requests.org">Requests</a>
module instead of a complete web scraper. The HTTP requests had to be made with a
time out, and also pass certain headers. I started customizing each call, until
I learned about the Requests <a href="http://docs.python-requests.org/en/master/user/advanced/">Session Objects</a>.</p>
<p>You create a session, as in ORM/JPA, where you can define a context, with certain properties
and control an orthogonal behavior.</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">requests</span>

<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Utility method to HTTP GET a URL&quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Utility method to HTTP POST a URL with data parameters&quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="n">requests</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="c"># x-test header will be sent with every request</span>
    <span class="n">s</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;x-test&#39;</span><span class="p">:</span> <span class="s">&#39;true&#39;</span><span class="p">})</span>

    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;user&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="s">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span> <span class="s">&#39;rememberne&#39;</span><span class="p">:</span> <span class="s">&#39;false&#39;</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&#39;https://portal.login.url&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&#39;https://portal.home.url&#39;</span><span class="p">)</span>
</pre></div>

<p>Besides the session object, that gives you ability to add headers to all requests,
you won&#8217;t have to worry about redirects. The library by default takes care
<a href="https://github.com/kennethreitz/requests/blob/dfad00a6e84bc75b12468ca29ccf4f971c813fc8/requests/sessions.py#L110">of that</a>
with a <a href="https://github.com/kennethreitz/requests/blob/dfad00a6e84bc75b12468ca29ccf4f971c813fc8/requests/models.py#L54">default limit of up to 30</a>.</p>

<p>Happy hacking!</p>

<!-- html -->

<pre><code>&lt;p class="postmetadata"&gt;

    &lt;small&gt;tags 
     [&amp;nbsp;&lt;a
        href="/tag/python"
        rel="tag"&gt;python&lt;/a&gt;&amp;nbsp;]&amp;nbsp;

    &lt;/small&gt;


    &lt;br/&gt;
    &lt;small&gt;posted in 
    [&amp;nbsp;&lt;a
        href="/blog"
        title="View all posts in blog"
        rel="category tag"&gt;blog&lt;/a&gt;&amp;nbsp;]&amp;nbsp;
    category &lt;/small&gt;

&lt;/p&gt;
</code></pre>
</div>

<div class="ui raised padded container segment">
    <h2>Using the AWS API with Python</h2>
    <p><small>kinow</small> @ <small>Oct 04, 2016&nbsp;21:15:03</small></p>







<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://kinoshita.eti.br/2016/10/04/using-the-aws-api-with-python" data-text="Using the AWS API with Python" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>Amazon Web Services provides a series of cloud services. When you access the web interface, most - if not all - of the actions you do there are actually translated into API calls.</p>
<p>They also provide SDK&#8217;s in several programming languages. With these SDK&#8217;s you are able to call the same API used by the web interface. Python has <a href="https://github.com/boto/boto3">boto</a> (or boto3) which lets you to automate several tasks in AWS.</p>
<p>But before you start using the API, you will need to <a href="https://web.archive.org/web/20160818112016/http://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSGettingStartedGuide/AWSCredentials.html">set up your access key</a>.</p>
<p>It is likely that with time you will have different roles, and may have different permissions with each role. You have to configure your local environment so that you can either use the command line Python utility (installed via <code>pip install awscli</code>) or with boto.</p>
<p>The awscli is a dependency for using boto3. After you install it, you need to run <code>aws configure</code>. It will create the <em>~/.aws/config</em> and <em>~/.aws/credentials</em> files. You can tweak these files to support multiple roles.</p>
<p>I followed the tutorials, but got all sorts of different issues. Then after debugging some locally installed dependencies, in special awscli files, I found that the following settings work for my environment.</p>
<div class="highlight"><pre><span class="c"># File: config</span>
<span class="o">[</span>profile default<span class="o">]</span>
<span class="nv">region</span> <span class="o">=</span> ap-southeast-2

<span class="o">[</span>profile profile1<span class="o">]</span>
<span class="nv">region</span> <span class="o">=</span> ap-southeast-2
<span class="nv">source_profile</span> <span class="o">=</span> default
<span class="nv">role_arn</span> <span class="o">=</span> arn:aws:iam::123:role/Developer

<span class="o">[</span>profile profile2<span class="o">]</span>
<span class="nv">region</span> <span class="o">=</span> ap-southeast-2
<span class="nv">source_profile</span> <span class="o">=</span> default
<span class="nv">role_arn</span> <span class="o">=</span> arn:aws:iam::456:role/Sysops
<span class="nv">mfa_serial</span> <span class="o">=</span> arn:aws:iam::789:mfa/user@domain.blabla
</pre></div>

<p>and</p>

<div class="highlight"><pre><span class="c"># File: credentials</span>
<span class="o">[</span>default<span class="o">]</span>
<span class="nv">aws_access_key_id</span> <span class="o">=</span> YOU_KEY_ID
<span class="nv">aws_secret_access_key</span> <span class="o">=</span> YOUR_SECRET
</pre></div>

<p>And once it is done you can, for example, confirm it is working with some S3 commands in Python.</p>

<div class="highlight"><pre><span class="c">#!/usr/bin/env python3</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">boto3</span>

<span class="n">session</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">profile_name</span><span class="o">=</span><span class="s">&#39;profile2&#39;</span><span class="p">)</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">resource</span><span class="p">(</span><span class="s">&#39;s3&#39;</span><span class="p">)</span>

<span class="n">found</span> <span class="o">=</span> <span class="bp">False</span>

<span class="n">name</span> <span class="o">=</span> <span class="s">&#39;mysuperduperbucket&#39;</span>

<span class="k">for</span> <span class="n">bucket</span> <span class="ow">in</span> <span class="n">s3</span><span class="o">.</span><span class="n">buckets</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">bucket</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">found</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Creating bucket...&quot;</span><span class="p">)</span>
    <span class="n">s3</span><span class="o">.</span><span class="n">create_bucket</span><span class="p">(</span><span class="n">Bucket</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

<span class="n">file_location</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s">&#39;samplefile.txt&#39;</span>
<span class="n">s3</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">upload_file</span><span class="p">(</span><span class="n">Filename</span><span class="o">=</span><span class="n">file_location</span><span class="p">,</span> <span class="n">Bucket</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">Key</span><span class="o">=</span><span class="s">&#39;book.txt&#39;</span><span class="p">)</span>
</pre></div>

<p>The AWS files in this example are using MFA too, the multi-factor authentication. So the first time you run this code you may be asked to generate a token, which will be cached for a short time.</p>

<p>That&#8217;s it for today.</p>

<p>Happy hacking!</p>

<!-- html -->

<pre><code>&lt;p class="postmetadata"&gt;

    &lt;small&gt;tags 
     [&amp;nbsp;&lt;a
        href="/tag/python"
        rel="tag"&gt;python&lt;/a&gt;&amp;nbsp;]&amp;nbsp;

     [&amp;nbsp;&lt;a
        href="/tag/aws"
        rel="tag"&gt;aws&lt;/a&gt;&amp;nbsp;]&amp;nbsp;

    &lt;/small&gt;


    &lt;br/&gt;
    &lt;small&gt;posted in 
    [&amp;nbsp;&lt;a
        href="/blog"
        title="View all posts in blog"
        rel="category tag"&gt;blog&lt;/a&gt;&amp;nbsp;]&amp;nbsp;
    category &lt;/small&gt;

&lt;/p&gt;
</code></pre>
</div>

<div class="ui raised padded container segment">
    <h2>Processing Vaisala Radiosonde data with Python, and creating GRUAN-like NetCDF files</h2>
    <p><small>kinow</small> @ <small>Jul 12, 2016&nbsp;21:18:03</small></p>







<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://kinoshita.eti.br/2016/07/12/processing-vaisala-radiosonde-data-with-python-and-creating-gruan-like-netcdf-files" data-text="Processing Vaisala Radiosonde data with Python, and creating GRUAN-like NetCDF files" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>One of my last projects involved parsing a few GB&#8217;s of data that was in a certain binary format,
and convert it into NetCDF files. In this post I will describe what was done, what I learned about radiosonde,
<a href="http://www.dwd.de/EN/research/international_programme/gruan/home.html">GRUAN</a> and other geek stuff. Ready?</p>
<h3>Vaisala Radiosonde data</h3>
<p>When I was told the data was in some binary format, I thought it would be similar to
parsing a flat file. That this would contain a fixed length entry, with the same
kind of item repeated multiple times.</p>
<p>Well, not exactly.</p>
<p>The files had been generated by an instrument made by <a href="http://www.vaisala.com">Vaisala</a>, a Finnish company. This
instrument is called a <strong>radiosonde</strong>. It is an instrument about the size of an old
mobile phone, that is launched with a balloon into the atmosphere.</p>
<p>I was lucky to be given the chance to release one of these balloons carrying a newer
version of this equipment.</p>
<p><img class="ui centered large bordered image" src="/2016/07/12/processing-vaisala-radiosonde-data-with-python-and-creating-gruan-like-netcdf-files/balloon-launch.jpg" alt="Radiosonde balloon launch" /></p>
<p>The balloon can carry equipments for measuring different things, like air pressure,
altitude, temperature, latitude, longitude, relative humidity, among others. Equipments
like the radiosonde send the data back to a ground-level station via radio,
normally in a short and constant interval.</p>
<!-- html -->

    <p>( <a href="/2016/07/12/processing-vaisala-radiosonde-data-with-python-and-creating-gruan-like-netcdf-files" >Read more &#8230;</a> )</p>

    <p class="postmetadata">

        <small>tags 
         [&nbsp;<a
            href="/tag/python"
            rel="tag">python</a>&nbsp;]&nbsp;

         [&nbsp;<a
            href="/tag/netcdf"
            rel="tag">netcdf</a>&nbsp;]&nbsp;

         [&nbsp;<a
            href="/tag/climate"
            rel="tag">climate</a>&nbsp;]&nbsp;

         [&nbsp;<a
            href="/tag/radiosonde"
            rel="tag">radiosonde</a>&nbsp;]&nbsp;

         [&nbsp;<a
            href="/tag/gruan"
            rel="tag">gruan</a>&nbsp;]&nbsp;

        </small>


        <br/>
        <small>posted in 
        [&nbsp;<a
            href="/blog"
            title="View all posts in blog"
            rel="category tag">blog</a>&nbsp;]&nbsp;
        category </small>

    </p>
</div>

<div class="ui raised padded container segment">
    <h2>Too many SQL variables exception in Graphite with SQLite3</h2>
    <p><small>kinow</small> @ <small>Jul 04, 2013&nbsp;13:54:53</small></p>







<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://kinoshita.eti.br/2013/07/04/too_many_sql_variables_in_graphite_with_sqlite3" data-text="Too many SQL variables exception in Graphite with SQLite3" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>Having run <a href="http://graphite.wikidot.com/">Graphite</a> for a while, today I found a rather annoying issue. We were using 
<a href="https://code.launchpad.net/~lucio.torre/graphite/add-events/+merge/69142">events</a>, and everything was working perfectly fine so far. But for the 24 last hours, 
the graph was blank. </p>
<p>Actually, in the dashboard, the graph was <em>missing</em>, being displayed as a gray box. 
Enabling the web inspector in Google Chrome I got the graph URL. Opening the link in 
a new tab gave me the exception message: <strong>too many SQL variables</strong> (<sup>1</sup>).</p>
<p>After some research, I found out this was a bug in SQLite. After trying to hack the code, 
and being concerned about using a patched version of Graphite and having to update it 
later, I decided to switch database. </p>
<p>But to avoid losing the graphs, users and other settings, including the events, I 
migrated the SQLite database to a MySQL server. This MySQL server was already installed in 
the server machine, since this machine hosted a <a href="http://www.zabbix.com/">Zabbix</a> server too.</p>
<p>Here are the steps required to migrate your database from SQLite to MySQL (<sup>2</sup>).</p>
<ul>
<li>Download <strong>sqlite3_mysql</strong> python script from <a href="http://www.redmine.org/boards/2/topics/12793">http://www.redmine.org/boards/2/topics/12793</a></li>
<li>Stop Apache/Nginx</li>
<li>mysql -u user -p -e &#8220;create database redmine graphite set utf8;&#8221; </li>
<li>sqlite3 graphite.db .dump | sqlite3-to-mysql.py | mysql -uroot -pyourpass graphite</li>
<li>Start Apache again</li>
</ul>
<p>After tail&#8217;ing the Graphite webapp log file, </p>
<div class="highlight"><pre>tail f- storage/log/webapp/error.log
</pre></div>

<p>I noticed the Python MySQLdb wasn&#8217;t installed.</p>
<div class="highlight"><pre><span class="n">ImproperlyConfigured</span><span class="p">:</span> <span class="n">Error</span> <span class="n">loading</span> <span class="n">MySQLdb</span> <span class="n">module</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">MySQLdb</span>
</pre></div>

<p>My server was an Ubuntu 13.04, so I installed the module simply with the following 
command.</p>
<div class="highlight"><pre>apt-get install python-mysqldb
</pre></div>

<p>Hope that helps!</p>
<p><small><sup>1</sup> You may have to enable *DEBUG* in your Django settings for seeing the exception in your browser</small></p>

<p><small><sup>2</sup> Zabbix needed some minor tweaks in order to use [MariaDB](https://mariadb.org/), but probably you can give it a try too</small></p><!-- html -->

    <p class="postmetadata">

        <small>tags 
         [&nbsp;<a
            href="/tag/monitoring"
            rel="tag">monitoring</a>&nbsp;]&nbsp;

         [&nbsp;<a
            href="/tag/python"
            rel="tag">python</a>&nbsp;]&nbsp;

        </small>


        <br/>
        <small>posted in 
        [&nbsp;<a
            href="/blog"
            title="View all posts in blog"
            rel="category tag">blog</a>&nbsp;]&nbsp;
        category </small>

    </p>
</div>

<div class="ui raised padded container segment">
    <h2>Graphite: Broken images</h2>
    <p><small>kinow</small> @ <small>Apr 17, 2013&nbsp;11:36:38</small></p>







<a href="https://twitter.com/share" class="twitter-share-button" data-url="http://kinoshita.eti.br/2013/04/17/graphite-broken-images" data-text="Graphite: Broken images" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>This morning I was setting up a <a href="http://graphite.wikidot.com/" title="Graphite">Graphite </a>server to collect metrics with <a href="https://github.com/etsy/statsd/" title="statsd">statsd</a>, <a href="http://logstash.net/" title="LogStash">LogStash </a>and <a href="https://github.com/jmxtrans/jmxtrans" title="jmxtrans">jmxtrans</a>. After following the instructions from @jgeurst, I&#8217;ve successfully installed Graphite.</p>

<p>I had previously installed another test box, so I decided to take a deeper look at the settings, write a <a href="https://puppetlabs.com/" title="Puppet">puppet</a> manifest and prepare this new box to become a production server. However, after browsing the webapp, all graphs were broken.</p>

<p>After googling a while, reading forums and bugs, I decided to open the <em>$GRAPHITE_HOME/webapp/graphite/render/views.py</em>, adding <em>log.rendering(&#8230;)</em> statements (not the most elegant solution, I know).</p>

<p>By following the program workflow I found out it was entering a block after checking if it should remotely render the image. This feature is turned on/off by <strong>REMOTE_RENDERING</strong> = True/False, in local_settings.py.</p>

<p>After setting this to <em>False</em> the problem was solved.</p><!-- html -->

    <p class="postmetadata">

        <small>tags 
         [&nbsp;<a
            href="/tag/monitoring"
            rel="tag">monitoring</a>&nbsp;]&nbsp;

         [&nbsp;<a
            href="/tag/python"
            rel="tag">python</a>&nbsp;]&nbsp;

        </small>


        <br/>
        <small>posted in 
        [&nbsp;<a
            href="/blog"
            title="View all posts in blog"
            rel="category tag">blog</a>&nbsp;]&nbsp;
        category </small>

    </p>
</div>
                    <p class="postmetadata">
                        
                        
                    </p>
                
                </div>
            </div>
        </div>
        <div class="ui vertical footer segment">
            <div class="ui center aligned container">
                           <div id="copy" class="">
                <p>&copy; <a href="/about"><span
                            class="b">Bru</span><span
                            class="r">no de</span> <span
                            class="a">Paula</span> <span
                            class="s"></span><span
                            class="i">Kinos</span><span
                            class="l">hita</span></a>
                </p>
            </div>
            </div>
         </div>
    </div>
</body>
</html>
<script src="/js/jquery-2.2.3.min.js"  type="text/javascript"></script>
    <script src="/css/semantic/dist/semantic.min.js"  type="text/javascript"></script>
    <script src="/js/jquery.prettyPhoto.js"></script>
<script type="text/javascript" charset="utf-8">
  $(document).ready(function(){
    $("a[rel^='prettyPhoto']").prettyPhoto({
        social_tools: false,
        autoplay_slideshow: false, 
        hideflash: true, 
        autoplay: false, 
        overlay_gallery: false
    });

    $("#toc")
        .sidebar({
          dimPage          : true,
          transition       : 'overlay',
          mobileTransition : 'uncover'
        })
    ;

    $("#toc")
        .sidebar('attach events', '.launch.button, .view-ui, .launch.item')
    ;
  });
</script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32767310-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
